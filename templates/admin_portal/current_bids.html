{% extends "admin_portal/admin_portal_base1.html" %}
{% load staticfiles %}
{% block extra_style %}
<!-- DataTables -->
<!-- DataTables -->
<link rel="stylesheet" href="{% static "plugins/datatables-bs4/css/dataTables.bootstrap4.css" %}">
<link rel="stylesheet" href="{% static "plugins/datatables-responsive/css/responsive.bootstrap4.min.css" %}">

<!-- jQuery -->
<script src=""{% static "plugins/jquery/jquery.min.js" %}"></script>
<!-- jQuery UI 1.11.4 -->
<script src=""{% static "plugins/jquery-ui/jquery-ui.min.js" %}"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.4.0/css/buttons.dataTables.min.css

">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/sweetalert2@9.15.2/dist/sweetalert2.min.css">
<link rel="stylesheet" href="{% static "dist/css/fancy.css" %}">


{% endblock %}

{% block page-nav %}
  <li class="breadcrumb-item"><a href="/mgr/dashboard/">home</a></li>
  <li class="breadcrumb-item active">current bids</li>
  {% endblock %}

{% block content %}
<!-- Large modal -->

<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Logger</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Unique Bids will be here
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
  
<div class="row col-12">
{% for bid in active_bids %}
  <div class="col-md-12 col-lg-6 col-xl-4">
   
    <div class="card-shadow-primary card-border mb-3 card">
        <div class="dropdown-menu-header">
            <div class="dropdown-menu-header-inner bg-primary">
                
                <div class="menu-header-content">
                    <img src="{{bid.product.image.url}}" style="width: 90%; height: auto;">
                </div>
            </div>
        </div>
        <div class="scroll-area-sm">
            <div class="scrollbar-container">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></i>
                                </div>
                                <div class="widget-content-left">
                                    <div class="widget-heading">Name: {{bid.product.name}}</div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></i>
                                </div>
                                <div class="widget-content-left">
                                    <div class="widget-heading">Bids placed: {{bid.entries.count}}</div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></i>
                                </div>
                                <div class="widget-content-left">
                                    <div class="widget-heading">Bid Code: {{bid.code}}</div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></i></div>
                                <div class="widget-content-left">
                                    <div class="widget-heading">Closes at: {{bid.closes_at}}</div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></div>
                                <div class="widget-content-left">
                                    <div class="widget-heading">Critical Mass: {{bid.critical_mass}}</div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></div>
                                <div class="widget-content-left">
                                    <div class="widget-heading">Critical mass Passed: {{bid.cm_passed}}</div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="list-group-item">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                <div class="widget-content-left center-elem mr-2">
                                    <i class="fas fa-ellipsis-v text-info"></i></div>
                                <div class="widget-content-left">
                                    <div class="widget-heading"><input type="checkbox" id="unique-view-toggle" data-toggle="toggle" data-on="<i class='fa fa-play'></i>" data-off="<i class='fa fa-pause'></i>"></div>
                                </div>
                                
                            </div>
                        </div>
                    </li>
                
                </ul>
            </div>
        </div>
        <div class="text-center d-block card-footer">
            
            <button type="button" class="border-0 btn-transition btn btn-outline-success create-similar" data-product="{{bid.product.name}}" data-code="{{bid.code}}">END AND CREATE SIMILAR</button>
        </div>
    </div>
   
</div>
{% endfor %}
</div>
  

{% endblock %}


{% block jslinks %}
<!-- DataTables -->

<script src="{% static "plugins/datatables/jquery.dataTables.js" %}"></script>
<script src="{% static "plugins/datatables-bs4/js/dataTables.bootstrap4.js" %}"></script>
<script src="{% static "plugins/datatables-responsive/js/dataTables.responsive.min.js" %}"></script>
<script src="{% static "plugins/datatables-responsive/js/responsive.bootstrap4.min.js" %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdn.datatables.net/plug-ins/1.10.11/sorting/date-euro.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9.15.2/dist/sweetalert2.all.min.js"></script>
<!-- <script src="{% static "dist/js/fancy.js" %}"></script> -->


{% endblock %}
{% block pagescripts%}
<script>
	$('.create-similar').click(function(){
        var code = $(this).data().code;
        var product = $(this).data().product;
        
        Swal.fire({
            title: "GET WINNER FOR " + product + " Bid Code " + code +" ?",
            text: "You will not be able to reverse this action",
            type: " warning ",
            showCancelButton: true,
            icon: 'warning',
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: "Yes, get winner",
            cancelButtonText: "No Cancel",
            showLoaderOnConfirm: true,
            
            preConfirm:function() {
                $.ajax({
                type: "POST",
                url: '/mgr/bid-actions/',
                data: {"code":code,"create_similar":true},
                success: function(data) {
                    Swal.fire({
                    icon:'success',
                    title: 'AND THE WINNER IS ...',
                    width: 800,
                    height:500,
                    padding: '3em',
                    html: `
                        <p>First Name:${data.firstname}</p>
                        <p>Middle Name:${data.middlename}</p>
                        <p>Last Name:${data.lastname}</p>
                        <p>Phone Number:${data.phonenumber}</p>
                        <p>Bid Value:${data.bidvalue}</p>
                    `,
                    confirmButtonText: 'Close',
                    
                    })
                },
                error: function(data) {
                    Swal.fire("Cancelled", "Action has been Cancelled: ) ", "error");
                }
                });
            }
        });
		
	});


</script>
<script type="text/javascript" charset="utf8">


    $(document).ready(function () {
  
      $('#currentbid').DataTable({
  
        
        
        "autoWidth": false,
        "bPaginate":false,
        "bFilter": false, //hide Search bar
        "bInfo": false// hide showing entries

        
      })
  
  
    })
  
  </script>
  <script>
      $('#getwinner').click(function(){
        Swal.fire({
            title: "GET WINNER",
            text: "You will not be able to reverse this action",
            type: " warning ",
            showCancelButton: true,
            icon: 'warning',
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: "Yes, get winner",
            cancelButtonText: " No, cancel!",
            showLoaderOnConfirm: true,
            
            preConfirm:function() {
                $.ajax({
                type: "POST",
                url: '/mgr/current-bid/',
                success: function(data) {
                    Swal.fire({
                    icon:'success',
                    title: 'AND THE WINNER IS ...',
                    width: 800,
                    height:500,
                    padding: '3em',
                    html: `
                        <pre><code>First Name:${data.firstname}</code></pre>
                        <pre><code>Middle Name:${data.middlename}</code></pre>
                        <pre><code>Last Name:${data.lastname}</code></pre>
                        <pre><code>Phone Number:${data.phonenumber}</code></pre>
                        <pre><code>Bid Value:${data.bidvalue}</code></pre>
                    `,
                    confirmButtonText: 'Close',
                    
                    })
                },
                error: function(data) {
                    Swal.fire("Cancelled", "Your imaginary file is safe: ) ", " error ");
                }
                });
            }
        });
      });
  </script>
  <script>
    $('#unique-view-toggle').click(function () {
        if ($(this).attr('checked')) {
            $('.bd-example-modal-lg').show();
        } else {
            $('.bd-example-modal-lg').show();
        }
     });
</script>

{% endblock %}